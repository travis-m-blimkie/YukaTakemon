---
title: "Building functions"
author: "Yuka Takemon"
slug: rladies-building-functions
categories:
  - R
  - functions
  - tutorial
  - RLadies
  - bonus_content
  - emoji
tags: [RLadies, R, functions, tutorial, bonus_content, emoji]
subtitle: ''
summary: ''
authors: [YukaTakemon]
lastmod: '2020-06-21'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: false
---



<p><strong>Workshop info</strong></p>
<ul>
<li><strong>When:</strong> July 10th, 6pm (PST, Vancouver, BC)</li>
<li><strong>Where:</strong> Online</li>
<li><strong>Requirements:</strong> Participants must have a laptop or desktop with a Mac, Linux, or Windows operating system. (Tablets and Chromebooks are not advised.) Please have the latest version of <a href="https://www.r-project.org/">R</a> and <a href="https://rstudio.com/products/rstudio/download/#download">RStudio</a> downloaded and running (free!).</li>
<li><strong>Code of conduct:</strong> Everyone participating in RLadies activities is required to conform to the <a href="https://github.com/rladies/starter-kit/wiki/Code-of-Conduct">Code of Conduct</a></li>
</ul>
<hr />
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<p>This short tutorial will attempt to show:</p>
<ul>
<li>What functions are and how are they useful</li>
<li>Why custom functions are necessary and when we might need them</li>
<li>How to build your own basic functions and how to source them</li>
</ul>
<p>This tutorial on “Building functions” was built for a <a href="https://twitter.com/RLadiesVan?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">R-Ladies Vancouver</a> workshop, which adapted works from <a href="http://swcarpentry.github.io/r-novice-gapminder/08-plot-ggplot2/index.html">The Carpentries</a> licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</p>
<hr />
</div>
<div id="what-are-functions" class="section level2">
<h2>What are functions?</h2>
<p>Functions package a sequence of operations into one, preserving it for ongoing use without the need to repeat them. In R functions are invoked with a special term followed immediately by <code>()</code>. For example you’ve probably already come across functions such as <code>library()</code> to load packages, <code>print()</code> to print characters, and <code>paste()</code> to string together multiple vectors to create one long vector.</p>
<p>You have probably noticed that functions provide:</p>
<ul>
<li>A single memorable name to invoke operations</li>
<li>A relief from the need to remember the individual operations</li>
<li>A defined set of inputs and expected outputs</li>
</ul>
<p>Functions are the basic building blocks of most programming languages, and user-defined functions constitute what we call “programming”. <strong>If you have written a function, you are a computer programmer!</strong></p>
<hr />
</div>
<div id="why-build-custom-functions" class="section level2">
<h2>Why build custom functions?</h2>
<p>Although base R package and packages on CRAN provide many useful functions, there are instances where you’ll need to repeat a series of operations that you wish could be summed up into one function.</p>
<hr />
</div>
<div id="defining-functions" class="section level2">
<h2>Defining functions</h2>
<p><strong>Here are the essential building blocks of a function</strong></p>
<ul>
<li><code>meaningful_name &lt;- function()</code></li>
<li>arguments are defined within <code>()</code></li>
<li>series of operations are included within <code>{}</code></li>
<li><code>return()</code> result</li>
</ul>
<pre class="r"><code>meaningful_name &lt;- function(argument1, arugment2, ...) {
  result &lt;- operation_using(argument1, argument2)
  return(result)
}</code></pre>
<p>Let’s build our first function together and try it out.</p>
<pre class="r"><code>multiply &lt;- function(a, b) {
  the_product &lt;- a * b
  return(the_product)
}

multiply(3, 4)</code></pre>
<pre><code>## [1] 12</code></pre>
<div id="what-did-you-observe" class="section level3">
<h3><span style="color: lightgreen;">What did you observe?</span>:</h3>
<p>What happened when you executed <code>multiply &lt;- function(a, b){...}</code>?</p>
<ul>
<li>No verbose</li>
<li>Addition of function to <em>global environment</em></li>
<li>No intermediate variables produced in <em>global environment</em></li>
</ul>
</div>
<div id="challenge-1-10-mins" class="section level3">
<h3><span style="color: darkorange;">Challenge 1:</span> (10 mins)</h3>
<p>Using the building blocks I showed you above, fill in the blanks below to build function that converts Fahrenheit to Kelvin. Here is the formula: <code>(°F − 32) × 5/9 + 273.15 = K</code>.</p>
<pre class="r"><code>F_to_K &lt;- _____(temp) {
  kelvin &lt;- ________
  _____(kelvin)
}</code></pre>
<p>Let’s test it out! 32°F is the freezing point, which should correspond to 273.15K.</p>
<pre class="r"><code>F_to_K(32)</code></pre>
<pre><code>## [1] 273.15</code></pre>
<hr />
</div>
<div id="challenge-2-10-mins" class="section level3">
<h3><span style="color: darkorange;">Challenge 2:</span> (10 mins)</h3>
<p>Now let’s build a function called <code>K_to_C()</code> that converts Kelvin to Celsius. The formula for the conversion is: <code>K - 273.15 = Celsius</code>.</p>
<p>Take the next 10 mins to figure out which on of these will give us the right function? if not why? Feel free to try them about.</p>
<ol style="list-style-type: upper-alpha">
<li></li>
</ol>
<pre class="r"><code>K_to_C() &lt;- function(temp){
 celsius &lt;- temp - 273.15
 return(celsius)
  }</code></pre>
<ol start="2" style="list-style-type: upper-alpha">
<li></li>
</ol>
<pre class="r"><code>K_to_C &lt;- function(temp){
 celsius &lt;- temp - 273.15
  }</code></pre>
<ol start="3" style="list-style-type: upper-alpha">
<li></li>
</ol>
<pre class="r"><code>K_to_C &lt;- function(kelvin){
 celsius &lt;- kelvin - 273.15
 return(celsius)
  }</code></pre>
<ol start="4" style="list-style-type: upper-alpha">
<li></li>
</ol>
<pre class="r"><code>K_to_C &lt;- function(kelvin){
 celsius &lt;- temp - 273.15
 return(celsius)
  }</code></pre>
<hr />
</div>
</div>
<div id="combining-functions" class="section level2">
<h2>Combining functions</h2>
<p>The real power of programming comes when you can mix and match various functions together. Once functions are defined, we can use it within other functions or string multiple functions together to create a single more powerful operation</p>
<div id="challenge-3-15-mins" class="section level3">
<h3><span style="color: darkorange;">Challenge 3:</span> (15 mins)</h3>
<p>Build a new function <code>F_to_C()</code> that uses the functions we previously built, <code>F_to_K()</code> and <code>K_to_C()</code>, to convert Fahrenheit directly to Celsius.</p>
<p>Let me start you off:</p>
<pre class="r"><code>F_to_C &lt;- function(){
  
}</code></pre>
<hr />
</div>
</div>
<div id="sourcing-functions" class="section level2">
<h2>Sourcing functions</h2>
<p>There are different ways to call on custom defined function. As we have been doing, you can defined your custom function at the beginning of each script as you use them. However, if you are using the same custom functions across different projects scripts it becomes too repetitive and forces you to either remember each step and dig through previous scripts to copy and paste it into your new script.</p>
<p>In programming, we want to reduce repetition if possible, and this is where sourcing functions come in.</p>
<p>First, let’s open a new R script and paste our custom functions from below. Next save the the code block in to a script called. <code>my_func.R</code>.</p>
<pre class="r"><code>F_to_K &lt;- function(temp) {
  kelvin &lt;- ((temp - 32) * (5 / 9)) + 273.15
  return(kelvin)
}

K_to_C &lt;- function(kelvin){
 celsius &lt;- kelvin - 273.15
 return(celsius)
}

F_to_C &lt;- function(temp){
  K_result &lt;- F_to_K(temp)
  celsius &lt;- K_to_C(K_result)
  return(celsius)
}</code></pre>
<p>Now let’s delete all the variables and functions we’ve created so far and “reset” our environment using <code>rm(list = ls())</code></p>
<p>To source our set of three functions, we use the <code>source()</code> function locate our <code>my_func.R</code> script.</p>
<pre class="r"><code>source(&quot;~/Desktop/my_func.R&quot;)</code></pre>
<p>Do you see three familiar functions in your <em>global environment</em>?</p>
<hr />
</div>
<div id="real-world-applications" class="section level2">
<h2>“Real world” applications</h2>
<p>Gapminder Foundation is a non-profit venture registered in Stockholm, Sweden, that promotes sustainable global development and achievement of the United Nations Millennium Development Goals by increased use and understanding of statistics and other information about social, economic and environmental development at local, national and global levels. <a href="https://www.gapminder.org/about-gapminder/our-mission/">[1]</a></p>
<p>We’re going to use the <code>gapminder</code> data set to apply our knowledge of functions.We can download the data set using <code>install.packages("gapminder")</code> before calling the <code>library()</code> function. Let’s see what we’re working with:</p>
<pre class="r"><code>library(gapminder)

str(gapminder)</code></pre>
<pre><code>## tibble [1,704 × 6] (S3: tbl_df/tbl/data.frame)
##  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
##  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
##  $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
##  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</code></pre>
<p>Let’s calculate the Gross Domestic Product of the data set.</p>
<pre class="r"><code>calcGDP &lt;- function(data) {
  gdp &lt;- data$pop * data$gdpPercap
  return(gdp)
}</code></pre>
<p>Let’s make it more interesting! Let’s add options to select <code>country</code> or <code>year</code>.</p>
<pre class="r"><code>calcGDP &lt;- function(data, year=NULL, country=NULL) {
  if(!is.null(year)) {
    data &lt;- data[data$year %in% year, ]
  }
  if (!is.null(country)) {
    data &lt;- data[data$country %in% country,]
  }
  gdp &lt;- data$pop * data$gdpPercap

  data$gdp &lt;- gdp
  return(data)
}</code></pre>
<p>Let’s talk about what is happening in <code>year = NULL</code> and <code>country = NULL</code></p>
<div id="challenge-4-10-mins" class="section level3">
<h3><span style="color: darkorange;">Challenge 4:</span> (10 mins)</h3>
<p>Test our your new <code>calcGDP</code> function to calculate the following:</p>
<ol style="list-style-type: decimal">
<li>What was the gdp of Myanmar in 1977?</li>
<li>What was the gdp of Togo in 1992?</li>
<li>What was the gdp of Canada in 2000?</li>
</ol>
<hr />
</div>
</div>
<div id="concluding-thoughts" class="section level2">
<h2>Concluding thoughts</h2>
<ul>
<li><strong>Congratulations!</strong> you are now a programmer, huzzah! 🥳 🎉</li>
<li>Custom functions can be useful for repetitive operations</li>
<li>Functions can be defined per script or called upon using <code>source()</code></li>
</ul>
<hr />
</div>
<div id="bonus-content-emojis" class="section level2">
<h2>Bonus content: Emojis</h2>
<p>While making this lesson, I learn to add Emojis into a R markdown document. I thought I’d share that here 😉:</p>
<p>You’ll need to install the <a href="https://github.com/hadley/emo">Emo package</a> from GitHub developed by <a href="https://github.com/hadley/">Hadley Wickham</a></p>
<pre class="r"><code>install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;hadley/emo&quot;)
library(emo)</code></pre>
<p>There are two ways to print emojis by using:</p>
<ul>
<li><code>ji_keywords</code></li>
<li><code>ji</code></li>
</ul>
<p>For example, <code>ji_keywords</code> evoke none unique emojis that call on similar category of emo(ji)s. For example <code>cats</code> have various unique cat expressions:</p>
<pre class="r"><code>keywords &lt;- ji_keyword
keywords$cat</code></pre>
<pre><code>##  [1] &quot;smiley_cat&quot;      &quot;smile_cat&quot;       &quot;joy_cat&quot;         &quot;heart_eyes_cat&quot; 
##  [5] &quot;smirk_cat&quot;       &quot;kissing_cat&quot;     &quot;scream_cat&quot;      &quot;crying_cat_face&quot;
##  [9] &quot;pouting_cat&quot;     &quot;cat&quot;             &quot;cat2&quot;</code></pre>
<pre><code>## 😺 
## 😸 
## 😹 
## 😻 
## 😼 
## 😽 
## 🙀 
## 😿 
## 😾 
## 🐱 
## 🐈</code></pre>
<p>To specify which specific cat you want you’ll have to specify that cat you want using <code>ji()</code> like so:</p>
<pre class="r"><code>ji(&quot;heart_eyes_cat&quot;)</code></pre>
<pre><code>## 😻</code></pre>
<p>You can find all the keywords on the <a href="https://github.com/hadley/emo">Emo package page</a> or see below for a sample:</p>
<pre><code>## aeroplane :  🛩🛫🛬
## airplane :  🛩🛫🛬
## alien :  👽👾
## alphabet :  🔤🔤
## amusement park :  🎡🎢
## anchor :  ⚓🔱
## angel :  😇😇👼
## angry :  😡😡😠👿💢💢🗯
## antenna :  📡📶
## apology :  🙇🙇‍♂️🙇‍♀️
## apple :  🍎🍏</code></pre>
<hr />
<p><strong>Have suggestions or comments? <a href="https://yukatakemon.netlify.app/#contact">Contact me</a></strong></p>
</div>
